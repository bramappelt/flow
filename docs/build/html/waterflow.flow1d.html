

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>waterflow.flow1d package &mdash; Flow v1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/drop.bmp"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="waterflow.utility package" href="waterflow.utility.html" />
    <link rel="prev" title="waterflow package" href="waterflow.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Flow
          

          
            
            <img src="_static/drop.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">flow</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="waterflow.html">waterflow package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="waterflow.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">waterflow.flow1d package</a></li>
<li class="toctree-l4"><a class="reference internal" href="waterflow.utility.html">waterflow.utility package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="waterflow.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="waterflow.html#module-waterflow">Module contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="waterflow.html#references">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Symbol Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flow</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">flow</a> &raquo;</li>
        
          <li><a href="waterflow.html">waterflow package</a> &raquo;</li>
        
      <li>waterflow.flow1d package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/waterflow.flow1d.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="waterflow-flow1d-package">
<h1>waterflow.flow1d package<a class="headerlink" href="#waterflow-flow1d-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-waterflow.flow1d.flowFE1d">
<span id="waterflow-flow1d-flowfe1d-module"></span><h2>waterflow.flow1d.flowFE1d module<a class="headerlink" href="#module-waterflow.flow1d.flowFE1d" title="Permalink to this headline">¶</a></h2>
<p>One dimensional finite elements flow module</p>
<dl class="class">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE">
<em class="property">class </em><code class="sig-prename descclassname">waterflow.flow1d.flowFE1d.</code><code class="sig-name descname">Flow1DFE</code><span class="sig-paren">(</span><em class="sig-param">id_</em>, <em class="sig-param">savepath='C:\Users\bramb\Documents\thesis\output'</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for solving flow problems numerically</p>
<p>This class represents an object that can be used to solve
(un)saturated 1-dimensional flow problems using finite elements.
To increase the accuracy of numerical solutions the Gaussian
quadrature method is used for integration approximation.</p>
<p>Most of the methods applied on the object will change its internal
state rather than returning a value. The change of the system is
saved in any of its public attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id_</strong> (<cite>str</cite>) – Name of the model object.</p></li>
<li><p><strong>savepath</strong> (<cite>str</cite>, optional) – Directory to which model data will be saved.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.id_">
<code class="sig-name descname">id_</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.id_" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the model object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.savepath">
<code class="sig-name descname">savepath</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.savepath" title="Permalink to this definition">¶</a></dt>
<dd><p>Model’s save directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc">
<code class="sig-name descname">systemfluxfunc</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds the selected flux function.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>function</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.nodes">
<code class="sig-name descname">nodes</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Nodal positions at which the system will be solved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.states">
<code class="sig-name descname">states</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.states" title="Permalink to this definition">¶</a></dt>
<dd><p>State solutions at the nodal positions as defined in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nodes" title="waterflow.flow1d.flowFE1d.Flow1DFE.nodes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nodes</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.nframe">
<code class="sig-name descname">nframe</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Two dimensional array that contains the midpoints and the lengths of
the nodal discretization in its columns respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.lengths">
<code class="sig-name descname">lengths</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>The same data as in the seconds column of <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nframe" title="waterflow.flow1d.flowFE1d.Flow1DFE.nframe"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nframe</span></code></a> but
in a different representation. This representation has the same length
as <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nodes" title="waterflow.flow1d.flowFE1d.Flow1DFE.nodes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nodes</span></code></a> which is more convenient for certain forcing
calculations at the nodal positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.coefmatr">
<code class="sig-name descname">coefmatr</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.coefmatr" title="Permalink to this definition">¶</a></dt>
<dd><p>Square jacobian matrix used in the finite elements solution procedure.
The exact dimension of the matrix is <img class="math" src="_images/math/411def6dca82a11b875076e8880848afb5881a71.png" alt="N \times N"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.BCs">
<code class="sig-name descname">BCs</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.BCs" title="Permalink to this definition">¶</a></dt>
<dd><p>This contains the system’s boundary conditions. The keys that indicate
the positions are “west” and “east”. The corresponding values have the
following format:</p>
<ul class="simple">
<li><p>(boundary_condition_value, type, domain_index).</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.spatflux">
<code class="sig-name descname">spatflux</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.spatflux" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the spatial fluxes on the model domain. # !! explain form</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.pointflux">
<code class="sig-name descname">pointflux</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.pointflux" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains the point fluxes on the model domain. # !! explain form</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.Spointflux">
<code class="sig-name descname">Spointflux</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.Spointflux" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains state dependent point fluxes on the model domain. # !! explain form</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.Sspatialflux">
<code class="sig-name descname">Sspatialflux</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.Sspatialflux" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains state dependent spatial fluxes on the model domain. # !! explain form</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.internal_forcing">
<code class="sig-name descname">internal_forcing</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.internal_forcing" title="Permalink to this definition">¶</a></dt>
<dd><p>The internal forcing of the system as calculated with
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc" title="waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">systemfluxfunc</span></code></a>, using the selected Gaussian quadrature
<code class="xref py py-attr docutils literal notranslate"><span class="pre">degree</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.forcing">
<code class="sig-name descname">forcing</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.forcing" title="Permalink to this definition">¶</a></dt>
<dd><p>All the forcing fluxes applied to the system. The dimension of this
matrix is <img class="math" src="_images/math/12617a66745b1b5f689f3a466529a4c201e26bac.png" alt="[1 \times N]"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.conductivities">
<code class="sig-name descname">conductivities</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.conductivities" title="Permalink to this definition">¶</a></dt>
<dd><p>pass</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.moisture">
<code class="sig-name descname">moisture</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.moisture" title="Permalink to this definition">¶</a></dt>
<dd><p>pass</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.fluxes">
<code class="sig-name descname">fluxes</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Fluxes through the <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nodes" title="waterflow.flow1d.flowFE1d.Flow1DFE.nodes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nodes</span></code></a>, defined to be positive to the
right.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.isinitial">
<code class="sig-name descname">isinitial</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.isinitial" title="Permalink to this definition">¶</a></dt>
<dd><p>First object for which was solved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>bool</cite>, default is True</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.isconverged">
<code class="sig-name descname">isconverged</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.isconverged" title="Permalink to this definition">¶</a></dt>
<dd><p>The system has converged to a solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>bool</cite>, default is False</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.solve_data">
<code class="sig-name descname">solve_data</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.solve_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds the solve information of the system including the following
key-value pairs:</p>
<ul>
<li><p>solved_objects - A <cite>list</cite> of Flow1DFE objects at solved time steps.</p></li>
<li><p>time - A <cite>list</cite> of times at which the model states are calculated.</p></li>
<li><p>dt - A <cite>list</cite> of time step sizes between consecutive model solutions.</p></li>
<li><div class="line-block">
<div class="line">iter - A <cite>list</cite> containing the number of iterations needed for</div>
<div class="line">consecutive model solutions to converge.</div>
</div>
</li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.runtime">
<code class="sig-name descname">runtime</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.runtime" title="Permalink to this definition">¶</a></dt>
<dd><p>The total time it takes for <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.solve" title="waterflow.flow1d.flowFE1d.Flow1DFE.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a> to find a solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.df_states">
<code class="sig-name descname">df_states</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Current information about the static model solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>pandas.core.frame.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.df_balance">
<code class="sig-name descname">df_balance</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Current static information about the water balance.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>pandas.core.frame.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.df_balance_summary">
<code class="sig-name descname">df_balance_summary</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_balance_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum of the columns as saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_balance" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_balance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_balance</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>pandas.core.frame.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times">
<code class="sig-name descname">dft_solved_times</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Dataframe version of <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.solve_data" title="waterflow.flow1d.flowFE1d.Flow1DFE.solve_data"><code class="xref py py-attr docutils literal notranslate"><span class="pre">solve_data</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>pandas.core.frame.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.dft_print_times">
<code class="sig-name descname">dft_print_times</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_print_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Objects that contain a solution to the model at specific times,
calculated with <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.transient_dataframeify" title="waterflow.flow1d.flowFE1d.Flow1DFE.transient_dataframeify"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transient_dataframeify()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>pandas.core.frame.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.dft_states">
<code class="sig-name descname">dft_states</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection of all <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_states" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_states"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_states</span></code></a> dataframes for the times in
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_solved_times</span></code></a> or at <code class="xref py py-attr docutils literal notranslate"><span class="pre">print_times</span></code> if not
<cite>None</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.dft_nodes">
<code class="sig-name descname">dft_nodes</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Nodes that are selected in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.transient_dataframeify" title="waterflow.flow1d.flowFE1d.Flow1DFE.transient_dataframeify"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transient_dataframeify()</span></code></a> are
saved at <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_solved_times</span></code></a> or at <code class="xref py py-attr docutils literal notranslate"><span class="pre">print_times</span></code>
if not <cite>None</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.dft_balance">
<code class="sig-name descname">dft_balance</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection of all <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_balance" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_balance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_balance</span></code></a> dataframes at
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_solved_times</span></code></a> or at <code class="xref py py-attr docutils literal notranslate"><span class="pre">print_times</span></code> if not
<cite>None</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.dft_balance_summary">
<code class="sig-name descname">dft_balance_summary</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_balance_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Collection of all <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_balance_summary" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_balance_summary"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_balance_summary</span></code></a> dataframes at
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_solved_times</span></code></a> or at <code class="xref py py-attr docutils literal notranslate"><span class="pre">print_times</span></code> if not
<cite>None</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>pandas.core.frame.DataFrame</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._west">
<code class="sig-name descname">_west</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._west" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal value that differentiates between a Dirichlet or Neumann
boundary condition on the western side of the domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._east">
<code class="sig-name descname">_east</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._east" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal value that differentiates between a Dirichlet or Neumann
boundary condition on the eastern side of the domain.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._delta">
<code class="sig-name descname">_delta</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixed value used for the finite displacement in the derivatives of the
jacobian matrix, <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.coefmatr" title="waterflow.flow1d.flowFE1d.Flow1DFE.coefmatr"><code class="xref py py-attr docutils literal notranslate"><span class="pre">coefmatr</span></code></a>. This value may be changed
manually for extremeley steep gradients.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.gauss_degree">
<code class="sig-name descname">gauss_degree</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.gauss_degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Degree or number of points used in the Gaussian quadrature procedure
for integral approximation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._xgauss">
<code class="sig-name descname">_xgauss</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._xgauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Roots of Legendre polynomial on the interval [0, 1] for the selected
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.gauss_degree" title="waterflow.flow1d.flowFE1d.Flow1DFE.gauss_degree"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gauss_degree</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>tuple</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._wgauss">
<code class="sig-name descname">_wgauss</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._wgauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Weights that correspond to <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE._xgauss" title="waterflow.flow1d.flowFE1d.Flow1DFE._xgauss"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_xgauss</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>tuple</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.gaussquad">
<code class="sig-name descname">gaussquad</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.gaussquad" title="Permalink to this definition">¶</a></dt>
<dd><p>Combination of corresponding values of <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE._xgauss" title="waterflow.flow1d.flowFE1d.Flow1DFE._xgauss"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_xgauss</span></code></a> and
<code class="xref py py-attr docutils literal notranslate"><span class="pre">wgauss</span></code> into a single data structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.xintegration">
<code class="sig-name descname">xintegration</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.xintegration" title="Permalink to this definition">¶</a></dt>
<dd><p>Absolute positions of the Gaussian quadrature points in the domain
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nodes" title="waterflow.flow1d.flowFE1d.Flow1DFE.nodes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nodes</span></code></a>. The shape of this list is
<img class="math" src="_images/math/cd91f55f653b1050f917727c2ffa358b5241d989.png" alt="[\Lambda \times N-1]"/>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.summarystring">
<code class="sig-name descname">summarystring</code><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.summarystring" title="Permalink to this definition">¶</a></dt>
<dd><p>Model information obtained by <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.summary" title="waterflow.flow1d.flowFE1d.Flow1DFE.summary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">summary()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._CMAT">
<code class="sig-name descname">_CMAT</code><span class="sig-paren">(</span><em class="sig-param">nodes</em>, <em class="sig-param">states</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._CMAT" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the jacobian matrix</p>
<p>Build the complete jacobian matrix according to the finite elements
scheme for the selected degree <img class="math" src="_images/math/65e60d95fc7bc06725cb967be10982e4bf310122.png" alt="\Lambda"/>. The jacobian matrix
<img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/> is assigned to <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.coefmatr" title="waterflow.flow1d.flowFE1d.Flow1DFE.coefmatr"><code class="xref py py-attr docutils literal notranslate"><span class="pre">coefmatr</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<cite>numpy.ndarray</cite>) – Array that contains the nodal positions.</p></li>
<li><p><strong>states</strong> (<cite>numpy.ndarray</cite>) – Array that contains the states at the nodal positions.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The jacobian matrix <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/> is build from three individual parts.</p>
<div class="math" id="equation-waterflow-flow1d-0">
<p><span class="eqno">(1)<a class="headerlink" href="#equation-waterflow-flow1d-0" title="Permalink to this equation">¶</a></span><img src="_images/math/72a6e445b022047bd98fe9062df9516053b61c63.png" alt="A = A_{sys} + A_{spat} + A_{point}"/></p>
</div><ul class="simple">
<li><p><img class="math" src="_images/math/8cd2b1f5dce2b3c2ead0dc1e50cbb896ebcb5cff.png" alt="A_{sys}"/>, derivatives of the <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc" title="waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">systemfluxfunc</span></code></a>.</p></li>
<li><p><img class="math" src="_images/math/2eeefdbab0e80111b8ea826710e919ab469655b2.png" alt="A_{spat}"/>, derivatives of functions in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.Sspatialflux" title="waterflow.flow1d.flowFE1d.Flow1DFE.Sspatialflux"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Sspatialflux</span></code></a>.</p></li>
<li><p><img class="math" src="_images/math/dbb4b0a4cbd3282fe3f4bfc0ce9f7875679dac6f.png" alt="A_{point}"/>, derivatives of functions in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.Spointflux" title="waterflow.flow1d.flowFE1d.Flow1DFE.Spointflux"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Spointflux</span></code></a>.</p></li>
</ul>
<p><strong>System’s flow equation jacobian</strong></p>
<p>The derivatives of the systemflux function, <img class="math" src="_images/math/90cab5ae70bdb6e45756490226ba488f522c4c4e.png" alt="Q"/>, are collected
in <img class="math" src="_images/math/8cd2b1f5dce2b3c2ead0dc1e50cbb896ebcb5cff.png" alt="A_{sys}"/>. The equation below describes how the
derivatives are calculated in which the Gaussian quadrature scheme
is accounted for.</p>
<div class="math" id="equation-waterflow-flow1d-1">
<p><span class="eqno">(2)<a class="headerlink" href="#equation-waterflow-flow1d-1" title="Permalink to this equation">¶</a></span><img src="_images/math/490998571befb14942309621a75dcd716743ea05.png" alt="\frac{\delta Q}{\delta x}_{i} = \sum_{\lambda}^{\Lambda} \frac{Q(X_{i,\lambda}, s_{i,\lambda}+\delta x, grad_{i}) - Q(X_{i,\lambda}, s_{i,\lambda}, grad_{i})}{\delta x} * w_{\lambda}"/></p>
</div><p>Argument <img class="math" src="_images/math/a26ef0697e4106dd8bf331323c197959819969a6.png" alt="X_{i, \lambda}"/> represents the absolute position
of the Gaussian quadrature point as saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.xintegration" title="waterflow.flow1d.flowFE1d.Flow1DFE.xintegration"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xintegration</span></code></a>.
The state argument <img class="math" src="_images/math/47436dc65107ce443bbd9355382b1a7a95bc9225.png" alt="s_{i,\lambda}"/> at this specific Gaussian
quadrature point is calculated as follows:</p>
<div class="math" id="equation-waterflow-flow1d-2">
<p><span class="eqno">(3)<a class="headerlink" href="#equation-waterflow-flow1d-2" title="Permalink to this equation">¶</a></span><img src="_images/math/0e2ba004144972071562fddc9d60b08d99b1b262.png" alt="s_{i,\lambda} = s_{i} * (1-p_{\lambda}) + s_{i+1} * p_{\lambda}"/></p>
</div><p>The third argument, <img class="math" src="_images/math/074e2c0fa3ded74bab6080d492baa2c235dd12ab.png" alt="grad_{i}"/>, is the gradient of the state
between the nodes of the current segment and is calculated as
shown below:</p>
<div class="math" id="equation-waterflow-flow1d-3">
<p><span class="eqno">(4)<a class="headerlink" href="#equation-waterflow-flow1d-3" title="Permalink to this equation">¶</a></span><img src="_images/math/c105d1ca25618fef1b227851641d34b006cd49d1.png" alt="grad_{i} = \frac{s_{i+1} - s{i}}{L_{i}}"/></p>
</div><p><img class="math" src="_images/math/8cd2b1f5dce2b3c2ead0dc1e50cbb896ebcb5cff.png" alt="A_{sys}"/> presents the structure of the sparse jacobian matrix
in which the derivatives of the systemflux function <img class="math" src="_images/math/90cab5ae70bdb6e45756490226ba488f522c4c4e.png" alt="Q"/> are
saved.</p>
<div class="math" id="equation-waterflow-flow1d-4">
<p><span class="eqno">(5)<a class="headerlink" href="#equation-waterflow-flow1d-4" title="Permalink to this equation">¶</a></span><img src="_images/math/8d13da7bdfe9bc304ce0b5d0eb379dc877fb731a.png" alt="A_{sys} = \begin{bmatrix}
                -\frac{\delta Q}{\delta x}_{i} &amp; -\frac{\delta Q}{\delta x}_{i} &amp;  &amp;  &amp;  &amp; \\
                \frac{\delta Q}{\delta x}_{i} &amp; \frac{\delta Q}{\delta x}_{i} -\frac{\delta Q}{\delta x}_{i+1} &amp; -\frac{\delta Q}{\delta x}_{i+1} &amp;  &amp; &amp; \\
                 &amp; \frac{\delta Q}{\delta x}_{i+1} &amp; \frac{\delta Q}{\delta x}_{i+1} -\frac{\delta Q}{\delta x}_{i+2} &amp; \ddots &amp; &amp; \\
                 &amp;  &amp; \ddots &amp; \ddots &amp; &amp; \ddots &amp; \\
                 &amp;  &amp;  &amp; \ddots &amp;  &amp; \frac{\delta Q}{\delta x}_{N-1} -\frac{\delta Q}{\delta x}_{N} &amp; -\frac{\delta Q}{\delta x}_{N} \\
                 &amp;  &amp;  &amp;  &amp;  &amp; \frac{\delta Q}{\delta x}_{N} &amp; \frac{\delta Q}{\delta x}_{N}
        \end{bmatrix}"/></p>
</div><p><strong>Spatial state dependent jacobian</strong></p>
<p>The derivatives of the state dependent spatial fluxes <img class="math" src="_images/math/b988975be41fd13b4d091c10202ba19374643586.png" alt="S"/>, if
present, are collected in <img class="math" src="_images/math/2eeefdbab0e80111b8ea826710e919ab469655b2.png" alt="A_{spat}"/>. The calculation of these
derivatives is described by the equations below. The values are summed
at every segment in the model domain, taking into account the selected
Gaussian quadrature scheme.</p>
<div class="math" id="equation-waterflow-flow1d-5">
<p><span class="eqno">(6)<a class="headerlink" href="#equation-waterflow-flow1d-5" title="Permalink to this equation">¶</a></span><img src="_images/math/54d1e2c324c82cb1901b3b4d451dddb19df32cfc.png" alt="\sum \frac{\delta S_{l}}{\delta x}_{i} = \sum_{\lambda=1}^{\Lambda} \sum_{j=1}^{n} \frac{S(X_{i,\lambda}, s_{i,\lambda} + \delta x)_{j} - S(X_{i,\lambda}, s_{i,\lambda})_{j}}{\delta x} * L_{i} * (1-p_{\lambda}) * w_{\lambda}"/></p>
</div><div class="math" id="equation-waterflow-flow1d-6">
<p><span class="eqno">(7)<a class="headerlink" href="#equation-waterflow-flow1d-6" title="Permalink to this equation">¶</a></span><img src="_images/math/6547be3392a19ba4839948b5ae3782bef13e5866.png" alt="\sum \frac{\delta S_{r}}{\delta x}_{i} = \sum_{\lambda=1}^{\Lambda} \sum_{j=1}^{n} \frac{S(X_{i,\lambda}, s_{i,\lambda} + \delta x)_{j} - S(X_{i,\lambda}, s_{i,\lambda})_{j}}{\delta x} * L_{i} * p_{\lambda} * w_{\lambda}"/></p>
</div><p>Argument <img class="math" src="_images/math/a26ef0697e4106dd8bf331323c197959819969a6.png" alt="X_{i, \lambda}"/> represents the absolute position
of the Gaussian quadrature point as saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.xintegration" title="waterflow.flow1d.flowFE1d.Flow1DFE.xintegration"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xintegration</span></code></a>.
The state argument <img class="math" src="_images/math/47436dc65107ce443bbd9355382b1a7a95bc9225.png" alt="s_{i,\lambda}"/> at this specific Gaussian
quadrature point is calculated as follows:</p>
<div class="math" id="equation-waterflow-flow1d-7">
<p><span class="eqno">(8)<a class="headerlink" href="#equation-waterflow-flow1d-7" title="Permalink to this equation">¶</a></span><img src="_images/math/0e2ba004144972071562fddc9d60b08d99b1b262.png" alt="s_{i,\lambda} = s_{i} * (1-p_{\lambda}) + s_{i+1} * p_{\lambda}"/></p>
</div><p>The structure of the sparse jacobian matrix, <img class="math" src="_images/math/2eeefdbab0e80111b8ea826710e919ab469655b2.png" alt="A_{spat}"/>, of the
sum of all state dependent spatialflux functions is shown below:</p>
<div class="math" id="equation-waterflow-flow1d-8">
<p><span class="eqno">(9)<a class="headerlink" href="#equation-waterflow-flow1d-8" title="Permalink to this equation">¶</a></span><img src="_images/math/0a31ab6fadd6e2abd11dff7fde03e2c87bba4070.png" alt="A_{spat} = \begin{bmatrix}
                \Sigma \frac{\delta S_{l}}{\delta x}_{i} &amp; \Sigma \frac{\delta S_{r}}{\delta x}_{i} &amp;  &amp;  &amp;  &amp; \\
                \Sigma \frac{\delta S_{l}}{\delta x}_{i} &amp; \Sigma \frac{\delta S_{r}}{\delta x}_{i} + \Sigma \frac{\delta S_{l}}{\delta x}_{i+1} &amp; \Sigma \frac{\delta S_{r}}{\delta x}_{i+1} &amp;  &amp; &amp; \\
                  &amp; \Sigma \frac{\delta S_{l}}{\delta x}_{i+1} &amp; \Sigma \frac{\delta S_{r}}{\delta x}_{i+1} + \Sigma \frac{\delta S_{l}}{\delta x}_{i+2} &amp; \ddots &amp; &amp; \\
                  &amp;  &amp; \ddots &amp; \ddots &amp; &amp; \ddots &amp; \\
                  &amp;  &amp;  &amp; \ddots &amp;  &amp; \Sigma \frac{\delta S_{r}}{\delta x}_{N-1} + \Sigma \frac{\delta S_{l}}{\delta x}_{N} &amp; \Sigma \frac{\delta S_{r}}{\delta x}_{N} \\
                  &amp;  &amp;  &amp;  &amp;  &amp; \Sigma \frac{\delta S_{l}}{\delta x}_{N} &amp; \Sigma \frac{\delta S_{r}}{\delta x}_{N}
           \end{bmatrix}"/></p>
</div><p><strong>Point state dependent jacobian</strong></p>
<p>The derivatives of the state dependend point fluxes, <img class="math" src="_images/math/c2aa3dff9bffb099e9dff196fd36aed56ec16baf.png" alt="P"/>, if
present, are collected in <img class="math" src="_images/math/dbb4b0a4cbd3282fe3f4bfc0ce9f7875679dac6f.png" alt="A_{point}"/>. The derivates are
calculated for the specific functions, distributed to the two nearest
nodes and summed to a total at this specific position. This is
described by the equations below:</p>
<div class="math" id="equation-waterflow-flow1d-9">
<p><span class="eqno">(10)<a class="headerlink" href="#equation-waterflow-flow1d-9" title="Permalink to this equation">¶</a></span><img src="_images/math/831dcddaa3075016a829bf2a5ac002328be8d8cb.png" alt="\sum \frac{\delta P_{l}}{\delta x}_{i} = \sum_{k=1}^{m} \frac{P(s_{i,k} + \delta x)_{k} + P(s_{i,k})_{k}}{\delta x} * rfac_{k}"/></p>
</div><div class="math" id="equation-waterflow-flow1d-10">
<p><span class="eqno">(11)<a class="headerlink" href="#equation-waterflow-flow1d-10" title="Permalink to this equation">¶</a></span><img src="_images/math/e810e9e2d5c1be578d70051c48b80e6b7c03332a.png" alt="\sum \frac{\delta P_{r}}{\delta x}_{i} = \sum_{k=1}^{m} \frac{P(s_{i,k} + \delta x)_{k} + P(s_{i,k})_{k}}{\delta x} * lfac_{k}"/></p>
</div><p>The state argument, <img class="math" src="_images/math/8eec10fe7edf1115d3e68f7c518ee1357cda7b8f.png" alt="s_{i,k}"/>, is calculated by linear
interpolation between the nearest nodes.</p>
<div class="math" id="equation-waterflow-flow1d-11">
<p><span class="eqno">(12)<a class="headerlink" href="#equation-waterflow-flow1d-11" title="Permalink to this equation">¶</a></span><img src="_images/math/58ce0c8fcb3dbcd2ca7c29a8d7e57aa9ea062c83.png" alt="s_{i,k} = s_{i} + rfac_{k} * (s_{i+1} - s_{i})"/></p>
</div><p>The structure of the jacobian matrix, <img class="math" src="_images/math/dbb4b0a4cbd3282fe3f4bfc0ce9f7875679dac6f.png" alt="A_{point}"/>, of the sum of
all state dependent pointflux functions is shown below:</p>
<div class="math" id="equation-waterflow-flow1d-12">
<p><span class="eqno">(13)<a class="headerlink" href="#equation-waterflow-flow1d-12" title="Permalink to this equation">¶</a></span><img src="_images/math/6db98522b92fa471cf29af8a09ba65133492111b.png" alt="A_{point} = \begin{bmatrix}
                \Sigma \frac{\delta P_{l}}{\delta x}_{i} &amp;  &amp;  &amp;  &amp;  &amp; \\
                &amp; \Sigma \frac{\delta P_{r}}{\delta x}_{i} + \Sigma \frac{\delta P_{l}}{\delta x}_{i+1} &amp;  &amp;  &amp;  &amp;  \\
                &amp;  &amp; \Sigma \frac{\delta P_{r}}{\delta x}_{i+1} + \Sigma \frac{\delta P_{l}}{\delta x}_{i+2} &amp;  &amp;  &amp;  \\
                &amp;  &amp;  &amp; \ddots &amp;  &amp;  &amp; \\
                &amp;  &amp;  &amp;  &amp;  &amp; \Sigma \frac{\delta P_{r}}{\delta x}_{N-1} + \Sigma \frac{\delta P_{l}}{\delta x}_{N}  &amp;  \\
                &amp;  &amp;  &amp;  &amp;  &amp;  &amp; \Sigma \frac{\delta P_{r}}{\delta x}_{N}
            \end{bmatrix}"/></p>
</div></dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._FE_precalc">
<code class="sig-name descname">_FE_precalc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._FE_precalc" title="Permalink to this definition">¶</a></dt>
<dd><p>Discretization dependent finite element scheme properties</p>
<p>Calculate the values for <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nframe" title="waterflow.flow1d.flowFE1d.Flow1DFE.nframe"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nframe</span></code></a> and <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.lengths" title="waterflow.flow1d.flowFE1d.Flow1DFE.lengths"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lengths</span></code></a>.</p>
<p class="rubric">Examples</p>
<p>pass</p>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Representation of the object as shown to the user</p>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._aggregate_forcing">
<code class="sig-name descname">_aggregate_forcing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._aggregate_forcing" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregation of state independent forcing</p>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._calc_theta_k">
<code class="sig-name descname">_calc_theta_k</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._calc_theta_k" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._check_boundaries">
<code class="sig-name descname">_check_boundaries</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._check_boundaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for proper boundary conditions</p>
<p>The system is checked for singularity. When a boundary condition
is not set explicitly a natural boundary condition (no flow) is
set as default.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>numpy.linalg.LinAlgError</strong> – This error is raised if the system has infinitely many solutions
    as a consequence of two Neumann boundary conditions or when none
    are entered.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Check boundaries&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">((</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="s2">&quot;west&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{&#39;west&#39;: (-0.3, &#39;Neumann&#39;, 0)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">_check_boundaries</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
 <span class="c">...</span>
<span class="gr">numpy.linalg.LinAlgError</span>: <span class="n">Singular matrix</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_dirichlet_BC</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;west&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{&#39;west&#39;: (-100, &#39;Dirichlet&#39;, 0)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">_check_boundaries</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{&#39;west&#39;: (-100, &#39;Dirichlet&#39;, 0), &#39;east&#39;: (0, &#39;Neumann&#39;, -1)}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._internal_forcing">
<code class="sig-name descname">_internal_forcing</code><span class="sig-paren">(</span><em class="sig-param">calcflux=False</em>, <em class="sig-param">calcbal=False</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._internal_forcing" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the system’s internal forcing</p>
<p>This is a core method for the numerical finite elements scheme. The
default behavior is to calculate the system’s internal forcing and
assign the values to <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.forcing" title="waterflow.flow1d.flowFE1d.Flow1DFE.forcing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">forcing</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calcflux</strong> (<cite>bool</cite>, default is False) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, fluxes through the nodes are calculated and
saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.fluxes" title="waterflow.flow1d.flowFE1d.Flow1DFE.fluxes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">fluxes</span></code></a>.</p></li>
<li><p><strong>calcbal</strong> (<cite>bool</cite>, default = False) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, internal forcing is saved in
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.internal_forcing" title="waterflow.flow1d.flowFE1d.Flow1DFE.internal_forcing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">internal_forcing</span></code></a> instead of <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.forcing" title="waterflow.flow1d.flowFE1d.Flow1DFE.forcing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">forcing</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This mathematical description of the internal forcing
calculation describes how the forcing at the nodes is calculated.
The direction of flow is defined to be positive to the right.
The equation below describes how the forcing at a specific node can
be calculated, taking the Gaussian quadrature procedure into account.</p>
<div class="math" id="equation-waterflow-flow1d-13">
<p><span class="eqno">(14)<a class="headerlink" href="#equation-waterflow-flow1d-13" title="Permalink to this equation">¶</a></span><img src="_images/math/52b39c695814388179a23798a396ed7ee9af0d70.png" alt="F_{i} = \sum_{\lambda=1}^{\Lambda} Q(X_{i,\lambda}, s_{i,\lambda}+\delta x, grad_{i}) * w_{\lambda}"/></p>
</div><p>Argument <img class="math" src="_images/math/a26ef0697e4106dd8bf331323c197959819969a6.png" alt="X_{i, \lambda}"/> represents the absolute position
of the Gaussian quadrature point as saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.xintegration" title="waterflow.flow1d.flowFE1d.Flow1DFE.xintegration"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xintegration</span></code></a>.
The state argument <img class="math" src="_images/math/47436dc65107ce443bbd9355382b1a7a95bc9225.png" alt="s_{i,\lambda}"/> at this specific Gaussian
quadrature point is calculated as follows:</p>
<div class="math" id="equation-waterflow-flow1d-14">
<p><span class="eqno">(15)<a class="headerlink" href="#equation-waterflow-flow1d-14" title="Permalink to this equation">¶</a></span><img src="_images/math/0e2ba004144972071562fddc9d60b08d99b1b262.png" alt="s_{i,\lambda} = s_{i} * (1-p_{\lambda}) + s_{i+1} * p_{\lambda}"/></p>
</div><p>The third argument, <img class="math" src="_images/math/074e2c0fa3ded74bab6080d492baa2c235dd12ab.png" alt="grad_{i}"/>, is the gradient of the state
between the nodes of the current segment and is calculated as
shown below:</p>
<div class="math" id="equation-waterflow-flow1d-15">
<p><span class="eqno">(16)<a class="headerlink" href="#equation-waterflow-flow1d-15" title="Permalink to this equation">¶</a></span><img src="_images/math/c105d1ca25618fef1b227851641d34b006cd49d1.png" alt="grad_{i} = \frac{s_{i+1} - s{i}}{L_{i}}"/></p>
</div><p>All internal fluxes are collected in <img class="math" src="_images/math/a63b15b3f47108102dc35d041637fc9ef296a36e.png" alt="F_{internal}"/>.</p>
<div class="math" id="equation-waterflow-flow1d-16">
<p><span class="eqno">(17)<a class="headerlink" href="#equation-waterflow-flow1d-16" title="Permalink to this equation">¶</a></span><img src="_images/math/c07092914b75f4b914e1461a3f33ba3f16e39164.png" alt="F_{internal} = \begin{bmatrix}
                    -F_{i}              \\
                    F_{i} - F_{i+1}    \\
                    F_{i+1} - F_{i+2}  \\
                    \vdots            \\
                    F_{N-1} - F_{N}    \\
                    -F_{N}
               \end{bmatrix}"/></p>
</div><div class="admonition note">
<p class="admonition-title">Note</p>
<p>If both of the arguments are truthy, the argument which occurs in
the method signature first has highest precedence. The internal
forcing is only assigned to the <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.forcing" title="waterflow.flow1d.flowFE1d.Flow1DFE.forcing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">forcing</span></code></a> attribute
when called with default arguments.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">conductivityfunctions</span> <span class="k">as</span> <span class="n">condf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility.fluxfunctions</span> <span class="k">import</span> <span class="n">richards_equation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility.helper</span> <span class="k">import</span> <span class="n">initializer</span>
</pre></div>
</div>
<p>Select soil 13, ‘loam’, from De Staringreeks <a class="bibtex reference internal" href="waterflow.html#strunk1979" id="id1">[SW79]</a>
and prepare the conductivity function with the soil parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">condf</span><span class="o">.</span><span class="n">soilselector</span><span class="p">([</span><span class="mi">13</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kfun</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_conductivity</span><span class="p">,</span> <span class="n">ksat</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">ksat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>Add states for a stationary no flow situation and check the
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.forcing" title="waterflow.flow1d.flowFE1d.Flow1DFE.forcing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">forcing</span></code></a> attribute for the internal forcing values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Internal forcing example&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_systemfluxfunction</span><span class="p">(</span><span class="n">richards_equation</span><span class="p">,</span> <span class="n">kfun</span><span class="o">=</span><span class="n">kfun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_initial_states</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_gaussian_quadrature</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">_internal_forcing</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">forcing</span>
<span class="go">array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">_internal_forcing</span><span class="p">(</span><span class="n">calcflux</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">fluxes</span>
<span class="go">array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</span>
</pre></div>
</div>
<p>Both arrays should consist of zeros because of the applied
equilibrium situation with no flow over the boundaries.</p>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._solve_initial_object">
<code class="sig-name descname">_solve_initial_object</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._solve_initial_object" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._statedep_forcing">
<code class="sig-name descname">_statedep_forcing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._statedep_forcing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE._update_storage_change">
<code class="sig-name descname">_update_storage_change</code><span class="sig-paren">(</span><em class="sig-param">prevstate</em>, <em class="sig-param">dt</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE._update_storage_change" title="Permalink to this definition">¶</a></dt>
<dd><p>feed new previous states function and timestep</p>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.add_dirichlet_BC">
<code class="sig-name descname">add_dirichlet_BC</code><span class="sig-paren">(</span><em class="sig-param">value</em>, <em class="sig-param">where</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.add_dirichlet_BC" title="Permalink to this definition">¶</a></dt>
<dd><p>Set boundary condition with fixed state</p>
<p>The Dirichlet boundary condition is implemented with this
method. The boundary condition is saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.BCs" title="waterflow.flow1d.flowFE1d.Flow1DFE.BCs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BCs</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<cite>int</cite> or <cite>float</cite>) – State value of the specific boundary</p></li>
<li><p><strong>where</strong> (<cite>str</cite>) – Position where the boundary condition will be set. Choose from
“west”, “left”, “down”, “east”, “right” or “up”. This argument
is case insensitive.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Describe how the boundary condition is implemented. !!!!!!!!!!!!!</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Dirichlet boundary conditions&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">((</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_dirichlet_BC</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;Up&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_dirichlet_BC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Down&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{&#39;east&#39;: (-100, &#39;Dirichlet&#39;, -1), &#39;west&#39;: (0, &#39;Dirichlet&#39;, 0)}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that a new boundary condition will overwrite an existing
one without a warning.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.add_neumann_BC">
<code class="sig-name descname">add_neumann_BC</code><span class="sig-paren">(</span><em class="sig-param">value</em>, <em class="sig-param">where</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.add_neumann_BC" title="Permalink to this definition">¶</a></dt>
<dd><p>Set boundary condition with fixed flux</p>
<p>The Neumann boundary condition is implemented with this
method. The boundary condition is saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.BCs" title="waterflow.flow1d.flowFE1d.Flow1DFE.BCs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BCs</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<cite>int</cite> or <cite>float</cite>) – Flux value of the specific boundary</p></li>
<li><p><strong>where</strong> (<cite>str</cite>) – Position where the boundary condition will be set. Choose from
“west”, “left”, “down”, “east”, “right” or “up”. This argument
is case insensitive.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Describe how the boundary condition is implemented. !!!!!!!!!!!!!
also note that FE.set_field1d needs to be called for the _east attr</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Neumann boundary conditions&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">((</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{&#39;east&#39;: (-0.1, &#39;Neumann&#39;, -1)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="s2">&quot;up&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{&#39;east&#39;: (-0.5, &#39;Neumann&#39;, -1)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;West&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{&#39;east&#39;: (-0.5, &#39;Neumann&#39;, -1), &#39;west&#39;: (-0.8, &#39;Neumann&#39;, 0)}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that a new boundary condition will overwrite an existing
one without a warning. This method will allow both boundaries
to be of type Neumann but remember that this won’t be useful
because of the infinite amount of solutions in such a situation.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.add_pointflux">
<code class="sig-name descname">add_pointflux</code><span class="sig-paren">(</span><em class="sig-param">rate</em>, <em class="sig-param">pos</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.add_pointflux" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a pointflux to the system</p>
<p class="rubric">Notes</p>
<p>Describe the calculation of <img class="math" src="_images/math/0ac002b95bdf53f34b0324be11dda0527b39cda1.png" alt="rfac"/> and <img class="math" src="_images/math/05f849c308f3b3287a5b63a095df2e3247025c1f.png" alt="lfac"/> here.</p>
<p class="rubric">Examples</p>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.add_spatialflux">
<code class="sig-name descname">add_spatialflux</code><span class="sig-paren">(</span><em class="sig-param">q</em>, <em class="sig-param">name=None</em>, <em class="sig-param">exact=False</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.add_spatialflux" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.calcbalance">
<code class="sig-name descname">calcbalance</code><span class="sig-paren">(</span><em class="sig-param">print_=False</em>, <em class="sig-param">invert=True</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.calcbalance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the water balance for the system</p>
<p>The water balance values are calculated at every position
in the domain and will be saved to <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_balance" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_balance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_balance</span></code></a>.
The summary of the water balance, which is the sum of all
relevant columns, is saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_balance_summary" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_balance_summary"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_balance_summary</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>print_</strong> (<cite>bool</cite>, default is <code class="docutils literal notranslate"><span class="pre">False</span></code>) – Print <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_balance_summary" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_balance_summary"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_balance_summary</span></code></a> to the console.</p></li>
<li><p><strong>invert</strong> (<cite>bool</cite>, default is <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Mirror <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_balance" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_balance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_balance</span></code></a> w.r.t. the x-axis.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The external fluxes, <img class="math" src="_images/math/6fd2860318fa09d7c44f574ad52a40cdf7ba79cf.png" alt="F_{external}"/>, are the sum of all point
and spatial fluxes.</p>
<div class="math" id="equation-waterflow-flow1d-17">
<p><span class="eqno">(18)<a class="headerlink" href="#equation-waterflow-flow1d-17" title="Permalink to this equation">¶</a></span><img src="_images/math/3c18b7c95229066b9935d7b9f7263431675ec231.png" alt="F_{external} = \sum_{j=1}^{n} F_{p_j} +
\sum_{j=1}^{m} F_{s_j}"/></p>
</div><p>The calculation of the point flux, <img class="math" src="_images/math/15bbf8df11e983126a6dd5ba6764df82fd571e72.png" alt="F_{p_j}"/>, depends on its
nature. If the point flux depends on position only, the accumulation is
straightforward. When the point flux is dependend on the state of the
the system, the distribution towards the surrounding nodes needs to be
calculated before values can be accumulated to its total. The
distribution to the nearest nodes is calculated as follows:</p>
<div class="math" id="equation-waterflow-flow1d-18">
<p><span class="eqno">(19)<a class="headerlink" href="#equation-waterflow-flow1d-18" title="Permalink to this equation">¶</a></span><img src="_images/math/27bda5c1d17446b2a52edcfa1588aac287286197.png" alt="node_{i} = F_{p_j}(s) * lfac"/></p>
</div><div class="math" id="equation-waterflow-flow1d-19">
<p><span class="eqno">(20)<a class="headerlink" href="#equation-waterflow-flow1d-19" title="Permalink to this equation">¶</a></span><img src="_images/math/df6caa98591163ebf3110b7d1098160756ae4cbb.png" alt="node_{i+1} = F_{p_j}(s) * rfac"/></p>
</div><p>where <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/> equals the state at the position of the point flux
which is calculated by linear interpolation. The calculation of the
fractions, that distribute the flux, <img class="math" src="_images/math/0ac002b95bdf53f34b0324be11dda0527b39cda1.png" alt="rfac"/> and <img class="math" src="_images/math/05f849c308f3b3287a5b63a095df2e3247025c1f.png" alt="lfac"/>
are described in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.add_pointflux" title="waterflow.flow1d.flowFE1d.Flow1DFE.add_pointflux"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_pointflux()</span></code></a>.</p>
<p>For the calculation of the spatial flux, <img class="math" src="_images/math/ce1e25681884da6adc230966e8a449e553e776f5.png" alt="F_{s_j}"/>, a similar
distinction exists. If the spatial flux is not dependend on state,
straightforward addition takes place. When there is a state
dependency, distributions towards the nodes is calculated as
described in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE._internal_forcing" title="waterflow.flow1d.flowFE1d.Flow1DFE._internal_forcing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_internal_forcing()</span></code></a> where
<img class="math" src="_images/math/ffbf92b8d57aeb7b65b929ec7e95902e7f4fcd3e.png" alt="F_{s_j}(x, s)"/> is substituted for the <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc" title="waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">systemfluxfunc</span></code></a>
<img class="math" src="_images/math/193f7a9847189dc810a577207c7ebc2b3c1bc6fa.png" alt="Q(x, s, grad)"/>. This calculation accounts for the selected
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.gauss_degree" title="waterflow.flow1d.flowFE1d.Flow1DFE.gauss_degree"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gauss_degree</span></code></a> and the state argument <img class="math" src="_images/math/106b04b320e75010b1d8029e59244f234f75e6f9.png" alt="s"/> is linearly
interpolated between the neareast nodes.</p>
<p>The internal forcing in the water balance is the sum of the internal
forcing as described in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE._internal_forcing" title="waterflow.flow1d.flowFE1d.Flow1DFE._internal_forcing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_internal_forcing()</span></code></a> and the external
forcing.</p>
<div class="math" id="equation-waterflow-flow1d-20">
<p><span class="eqno">(21)<a class="headerlink" href="#equation-waterflow-flow1d-20" title="Permalink to this equation">¶</a></span><img src="_images/math/19310ba848a035a9ff88833353834d1120ad2a4d.png" alt="F_{total\_internal} = F_{internal} + F_{external}"/></p>
</div><p>The top and bottom values in <img class="math" src="_images/math/ac7008d0a3939c7d267bb39ffe2560cbfee3c555.png" alt="F_{total\_internal}"/> are corrected
for the flow over the boundaries. The flow over the boundaries is
calculated as the difference of <img class="math" src="_images/math/ac7008d0a3939c7d267bb39ffe2560cbfee3c555.png" alt="F_{total\_internal}"/> -
<img class="math" src="_images/math/82f8146372613edd07fa9be8b9227bdde1c42ac4.png" alt="\Delta s"/> at those boundary nodes.</p>
<p>The net flux is calculated as follows:</p>
<div class="math" id="equation-waterflow-flow1d-21">
<p><span class="eqno">(22)<a class="headerlink" href="#equation-waterflow-flow1d-21" title="Permalink to this equation">¶</a></span><img src="_images/math/e24f3b3a2579fa18a50ffc6e95fec2bd082d9e2b.png" alt="F_{net} = F_{total\_internal} - \Delta s"/></p>
</div><p>Where <img class="math" src="_images/math/82f8146372613edd07fa9be8b9227bdde1c42ac4.png" alt="\Delta s"/> represents the storage change between
iterations at every node in the domain.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the storage change <img class="math" src="_images/math/82f8146372613edd07fa9be8b9227bdde1c42ac4.png" alt="\Delta s"/> is entered into the
model as an external flux, in the calculation of the water balance
this term is handled as a separate flux which is not included in
the <img class="math" src="_images/math/6fd2860318fa09d7c44f574ad52a40cdf7ba79cf.png" alt="F_{external}"/> term.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">conductivityfunctions</span> <span class="k">as</span> <span class="n">condf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">fluxfunctions</span> <span class="k">as</span> <span class="n">fluxf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility.helper</span> <span class="k">import</span> <span class="n">initializer</span>
</pre></div>
</div>
<p>Select soil 13, ‘loam’, from De Staringreeks <a class="bibtex reference internal" href="waterflow.html#strunk1979" id="id2">[SW79]</a>
and prepare the conductivity function and theta-h relation with the
soil parameters. These functions are the arguments to the fluxfunction
and the storage change function repectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">condf</span><span class="o">.</span><span class="n">soilselector</span><span class="p">([</span><span class="mi">13</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_h</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_pressureh</span><span class="p">,</span> <span class="n">theta_r</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">t_res</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">theta_s</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">t_sat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kfun</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_conductivity</span><span class="p">,</span> <span class="n">ksat</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">ksat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storage_change</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">fluxf</span><span class="o">.</span><span class="n">storage_change</span><span class="p">,</span> <span class="n">fun</span><span class="o">=</span><span class="n">theta_h</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Calculate water balance&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_systemfluxfunction</span><span class="p">(</span><span class="n">fluxf</span><span class="o">.</span><span class="n">richards_equation</span><span class="p">,</span> <span class="n">kfun</span><span class="o">=</span><span class="n">kfun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_dirichlet_BC</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;west&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Constant boundary flow of 0.3 cm/d out of the system</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;east&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># theta_h function needs to be added manually to be included in the water balance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">tfun</span> <span class="o">=</span> <span class="n">theta_h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extraction of 0.001 cm/d over the complete domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_spatialflux</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;extraction&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add storage change function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_spatialflux</span><span class="p">(</span><span class="n">storage_change</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Solve the system for one time step (dt=0.01 d)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iters</span> <span class="o">=</span> <span class="n">FE</span><span class="o">.</span><span class="n">dt_solve</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">calcbalance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">df_balance</span>
<span class="go">    nodes  spat-extraction  storage_change  internal  all-spatial  all-points  all-external           net    fluxes</span>
<span class="go">0     0.0          -0.0005        0.144730 -0.144730      -0.0005         0.0       -0.0005  0.000000e+00  0.155770</span>
<span class="go">1    -1.0          -0.0010        0.266555 -0.266555      -0.0010         0.0       -0.0010 -4.663325e-12 -0.109784</span>
<span class="go">2    -2.0          -0.0010        0.222706 -0.222706      -0.0010         0.0       -0.0010 -2.797818e-12 -0.331490</span>
<span class="go">3    -3.0          -0.0010        0.182558 -0.182558      -0.0010         0.0       -0.0010 -6.783463e-14 -0.513048</span>
<span class="go">4    -4.0          -0.0010        0.145754 -0.145754      -0.0010         0.0       -0.0010  1.635247e-12 -0.657801</span>
<span class="go">5    -5.0          -0.0010        0.112096 -0.112096      -0.0010         0.0       -0.0010  1.979528e-12 -0.768897</span>
<span class="go">6    -6.0          -0.0010        0.081552 -0.081552      -0.0010         0.0       -0.0010  1.637579e-12 -0.849449</span>
<span class="go">7    -7.0          -0.0010        0.054287 -0.054287      -0.0010         0.0       -0.0010  1.292744e-12 -0.902736</span>
<span class="go">8    -8.0          -0.0010        0.030765 -0.030765      -0.0010         0.0       -0.0010  1.127098e-12 -0.932501</span>
<span class="go">9    -9.0          -0.0010        0.012078 -0.012078      -0.0010         0.0       -0.0010  1.573075e-12 -0.943580</span>
<span class="go">10  -10.0          -0.0005        0.002068 -0.002068      -0.0005         0.0       -0.0005  0.000000e+00 -0.945148</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">df_balance_summary</span>
<span class="go">spat-extraction   -1.000000e-02</span>
<span class="go">storage_change     1.255148e+00</span>
<span class="go">internal          -1.255148e+00</span>
<span class="go">all-spatial       -1.000000e-02</span>
<span class="go">all-points         0.000000e+00</span>
<span class="go">all-external      -1.000000e-02</span>
<span class="go">net                1.716294e-12</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.dataframeify">
<code class="sig-name descname">dataframeify</code><span class="sig-paren">(</span><em class="sig-param">invert</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dataframeify" title="Permalink to this definition">¶</a></dt>
<dd><p>Write current static model to dataframe</p>
<p>Save the current model results to <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_states" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_states"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_states</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>invert</strong> (<cite>bool</cite>) – Mirror <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.df_states" title="waterflow.flow1d.flowFE1d.Flow1DFE.df_states"><code class="xref py py-attr docutils literal notranslate"><span class="pre">df_states</span></code></a> w.r.t. the x-axis.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>At least, lengths, nodes, states and the internal forcing are written
to the dataframe.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">conductivityfunctions</span> <span class="k">as</span> <span class="n">condf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">fluxfunctions</span> <span class="k">as</span> <span class="n">fluxf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility.helper</span> <span class="k">import</span> <span class="n">initializer</span>
</pre></div>
</div>
<p>Select soil 13, ‘loam’, from De Staringreeks <a class="bibtex reference internal" href="waterflow.html#strunk1979" id="id3">[SW79]</a>
and prepare the conductivity function and theta-h relation with the
soil parameters. These functions are the arguments to the fluxfunction
and the storage change function repectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">condf</span><span class="o">.</span><span class="n">soilselector</span><span class="p">([</span><span class="mi">13</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_h</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_pressureh</span><span class="p">,</span> <span class="n">theta_r</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">t_res</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">theta_s</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">t_sat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kfun</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_conductivity</span><span class="p">,</span> <span class="n">ksat</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">ksat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storage_change</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">fluxf</span><span class="o">.</span><span class="n">storage_change</span><span class="p">,</span> <span class="n">fun</span><span class="o">=</span><span class="n">theta_h</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;static df_states dataframe&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_systemfluxfunction</span><span class="p">(</span><span class="n">fluxf</span><span class="o">.</span><span class="n">richards_equation</span><span class="p">,</span> <span class="n">kfun</span><span class="o">=</span><span class="n">kfun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_dirichlet_BC</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;west&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Constant boundary flow of 0.3 cm/d out of the system</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;east&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># theta_h add manually to be included in the dataframe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">tfun</span> <span class="o">=</span> <span class="n">theta_h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add storage change function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_spatialflux</span><span class="p">(</span><span class="n">storage_change</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Solve the system for one time step (dt=0.01 d)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iters</span> <span class="o">=</span> <span class="n">FE</span><span class="o">.</span><span class="n">dt_solve</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">dataframeify</span><span class="p">(</span><span class="n">invert</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">df_states</span>
<span class="go">    lengths  nodes    states  moisture  conductivities  storage_change  internal_forcing</span>
<span class="go">0       0.5    0.0 -9.304032  0.416865        5.936014        0.144618          0.155382</span>
<span class="go">1       1.0   -1.0 -8.278454  0.417344        6.220225        0.266340         -0.266340</span>
<span class="go">2       1.0   -2.0 -7.295883  0.417781        6.519720        0.222509         -0.222509</span>
<span class="go">3       1.0   -3.0 -6.345835  0.418182        6.840203        0.182383         -0.182383</span>
<span class="go">4       1.0   -4.0 -5.419426  0.418549        7.189191        0.145605         -0.145605</span>
<span class="go">5       1.0   -5.0 -4.509093  0.418885        7.577188        0.111975         -0.111975</span>
<span class="go">6       1.0   -6.0 -3.608378  0.419190        8.020009        0.081460         -0.081460</span>
<span class="go">7       1.0   -7.0 -2.711757  0.419462        8.544065        0.054224         -0.054224</span>
<span class="go">8       1.0   -8.0 -1.814469  0.419698        9.201041        0.030729         -0.030729</span>
<span class="go">9       1.0   -9.0 -0.912220  0.419888       10.126956        0.012064         -0.012064</span>
<span class="go">10      0.5  -10.0  0.000000  0.420000       12.980000        0.002066          0.951906</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.dt_solve">
<code class="sig-name descname">dt_solve</code><span class="sig-paren">(</span><em class="sig-param">dt</em>, <em class="sig-param">maxiter=500</em>, <em class="sig-param">threshold=0.001</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dt_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>solve the system for one specific time step</p>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.remove_BC">
<code class="sig-name descname">remove_BC</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.remove_BC" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove boundary conditions</p>
<p>Calling this method with default arguments will clear all boundary
conditions set. To clear a specific boundary condition the name
needs to be passed explicitly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> (<cite>str</cite>, optional.) – The positional arguments should contain the name of the boundary
conditions as saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.BCs" title="waterflow.flow1d.flowFE1d.Flow1DFE.BCs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">BCs</span></code></a>. This can be “west” or
“east”.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – This exception is raised when <code class="docutils literal notranslate"><span class="pre">*args</span></code> contains an invalid
    boundary condition name.</p></li>
<li><p><strong>. note::</strong> – This is the safe way to remove the boundary conditions because it
    will also handle and reset the <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE._west" title="waterflow.flow1d.flowFE1d.Flow1DFE._west"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_west</span></code></a> and
    <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE._east" title="waterflow.flow1d.flowFE1d.Flow1DFE._east"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_east</span></code></a> attributes which are associated with the
    implementation of the boundary conditions in the numerical scheme.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Boundary condition removal&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">((</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_dirichlet_BC</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;up&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_neumann_BC</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;down&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{&#39;east&#39;: (-100, &#39;Dirichlet&#39;, -1), &#39;west&#39;: (0.0, &#39;Neumann&#39;, 0)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">remove_BC</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
 <span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">&#39;No boundary named right.&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">remove_BC</span><span class="p">(</span><span class="s2">&quot;west&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{&#39;east&#39;: (-100, &#39;Dirichlet&#39;, -1)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">remove_BC</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">BCs</span>
<span class="go">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.remove_pointflux">
<code class="sig-name descname">remove_pointflux</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.remove_pointflux" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.remove_spatialflux">
<code class="sig-name descname">remove_spatialflux</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.remove_spatialflux" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">savepath=None</em>, <em class="sig-param">dirname=None</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model data to disk</p>
<p>The transient dataframes created with
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.transient_dataframeify" title="waterflow.flow1d.flowFE1d.Flow1DFE.transient_dataframeify"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transient_dataframeify()</span></code></a> and the model summary as created
with <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.summary" title="waterflow.flow1d.flowFE1d.Flow1DFE.summary"><code class="xref py py-meth docutils literal notranslate"><span class="pre">summary()</span></code></a> will be saved to disk by this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>savepath</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, default is <code class="docutils literal notranslate"><span class="pre">OUTPUT_DIR</span></code>) – A base path to which runs will be saved.</p></li>
<li><p><strong>dirname</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code>, default is a chronological name) – Name of save directory that is appended to savepath.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All dataframes of the form <code class="docutils literal notranslate"><span class="pre">dft_&lt;name&gt;</span></code>, if populated,
are written to disk in a <cite>.xlsx</cite> extension. The model summary
is saved as <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.id_" title="waterflow.flow1d.flowFE1d.Flow1DFE.id_"><code class="xref py py-attr docutils literal notranslate"><span class="pre">id_</span></code></a> with a <cite>.txt</cite> extension.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Data that already exists in the target directory will
be overwritten with new data. Prevent this by selecting a
new directory name or set <code class="docutils literal notranslate"><span class="pre">dirname=None</span></code> to automatically
generate a chronological directory name which is always unique.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.set_field1d">
<code class="sig-name descname">set_field1d</code><span class="sig-paren">(</span><em class="sig-param">nodes</em>, <em class="sig-param">degree=1</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.set_field1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the system’s discretization</p>
<p><a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.states" title="waterflow.flow1d.flowFE1d.Flow1DFE.states"><code class="xref py py-attr docutils literal notranslate"><span class="pre">states</span></code></a> and <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.forcing" title="waterflow.flow1d.flowFE1d.Flow1DFE.forcing"><code class="xref py py-attr docutils literal notranslate"><span class="pre">forcing</span></code></a> are initialized with zeros.
The Gaussian quadrature <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.gauss_degree" title="waterflow.flow1d.flowFE1d.Flow1DFE.gauss_degree"><code class="xref py py-attr docutils literal notranslate"><span class="pre">gauss_degree</span></code></a> is set and the
system’s discretization characteristics are calculated with
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE._FE_precalc" title="waterflow.flow1d.flowFE1d.Flow1DFE._FE_precalc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_FE_precalc()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nodes</strong> (<cite>tuple</cite> or <cite>list</cite> or <cite>numpy.ndarray</cite>) – A tuple of the form (start, end, number of nodes) for a linearly
spaced domain or a sequence of nodes that contains the nodal
positions explicitly.</p></li>
<li><p><strong>degree</strong> (<cite>int</cite>, default is 1) – Set the Gaussian quadrature degree, this is equivalent to the
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.set_gaussian_quadrature" title="waterflow.flow1d.flowFE1d.Flow1DFE.set_gaussian_quadrature"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_gaussian_quadrature()</span></code></a> method.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that the absolute positions of the nodes increase
towards the right of the domain.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility.spacing</span> <span class="k">import</span> <span class="n">biasedspacing</span>
</pre></div>
</div>
<p>Linear nodal spacing with a non-default Gaussian degree.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Several spacings&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">((</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">nodes</span>
<span class="go">array([-10.,  -9.,  -8.,  -7.,  -6.,  -5.,  -4.,  -3.,  -2.,  -1.,   0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">_xgauss</span>
<span class="go">(0.1127016653792583, 0.5, 0.8872983346207417)</span>
</pre></div>
</div>
<p>Unstructured nodes using the
<a class="reference internal" href="waterflow.utility.html#waterflow.utility.spacing.biasedspacing" title="waterflow.utility.spacing.biasedspacing"><code class="xref py py-func docutils literal notranslate"><span class="pre">biasedspacing()</span></code></a> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unstructured_nodes</span> <span class="o">=</span> <span class="n">biasedspacing</span><span class="p">(</span><span class="n">numnodes</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">lb</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">rb</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">maxdist</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">(</span><span class="n">unstructured_nodes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">nodes</span>
<span class="go">array([-10.        ,  -9.61405656,  -9.29864794,  -8.94730706,</span>
<span class="go">        -8.54868046,  -8.0844499 ,  -7.12803197,  -6.        ,</span>
<span class="go">        -4.        ,  -2.        ,   0.        ])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.set_gaussian_quadrature">
<code class="sig-name descname">set_gaussian_quadrature</code><span class="sig-paren">(</span><em class="sig-param">degree=1</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.set_gaussian_quadrature" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates Gaussian quadrature roots and weights</p>
<p>The values calculated with this method are stored in the object’s
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE._xgauss" title="waterflow.flow1d.flowFE1d.Flow1DFE._xgauss"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_xgauss</span></code></a> and <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE._wgauss" title="waterflow.flow1d.flowFE1d.Flow1DFE._wgauss"><code class="xref py py-attr docutils literal notranslate"><span class="pre">_wgauss</span></code></a> attributes. The absolute
positions of the Gaussian quadrature points in the ~domain are
calculated and saved in ~xintegration`.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>degree</strong> (<cite>int</cite>, default is 1) – Number of points used in the Gaussian quadrature procedure.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="math" id="equation-waterflow-flow1d-22">
<p><span class="eqno">(23)<a class="headerlink" href="#equation-waterflow-flow1d-22" title="Permalink to this equation">¶</a></span><img src="_images/math/a52ba99d3986691e2aad20e8ccad1d9d7c17db43.png" alt="P_{\Lambda}(p) = \text{Legendre polynomials of degree $\Lambda$}"/></p>
</div><div class="math" id="equation-waterflow-flow1d-23">
<p><span class="eqno">(24)<a class="headerlink" href="#equation-waterflow-flow1d-23" title="Permalink to this equation">¶</a></span><img src="_images/math/4e3010d8c0c2496f79e1cc6a58332c2d24a634bc.png" alt="w_{\lambda} = \frac{2}{\left(\left(1 - p_{\lambda}^{2}\right) *
P_{\Lambda}^{'}(p_{\lambda})^{2}\right)}"/></p>
</div><p>See <a class="bibtex reference internal" href="waterflow.html#strunk1979" id="id4">[SW79]</a> for an introduction to stylish blah, blah…</p>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.set_initial_states">
<code class="sig-name descname">set_initial_states</code><span class="sig-paren">(</span><em class="sig-param">states</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.set_initial_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the initial states</p>
<p>Although the main purpose of this method is to set the initial states
it can be used to manipulate the states at any given point in time. The
states are written to <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.states" title="waterflow.flow1d.flowFE1d.Flow1DFE.states"><code class="xref py py-attr docutils literal notranslate"><span class="pre">states</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>states</strong> (<cite>int</cite> or <cite>float</cite> or <cite>list</cite> or <cite>numpy.ndarray</cite>) – Set the states to an uniform value or vary the states with a
sequence like argument.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the states can only be set when the discretization of
the system is known.</p>
</div>
<p class="rubric">Examples</p>
<p>Set the initial states of the system or use the default setting.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Setting states&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">((</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">states</span>
<span class="go">array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_initial_states</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">states</span>
<span class="go">array([  0.,  -1.,  -2.,  -3.,  -4.,  -5.,  -6.,  -7.,  -8.,  -9., -10.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.set_systemfluxfunction">
<code class="sig-name descname">set_systemfluxfunction</code><span class="sig-paren">(</span><em class="sig-param">function</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.set_systemfluxfunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement the governing flow equation</p>
<p>The <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc" title="waterflow.flow1d.flowFE1d.Flow1DFE.systemfluxfunc"><code class="xref py py-attr docutils literal notranslate"><span class="pre">systemfluxfunc</span></code></a> is set with the governing flow
equation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function</strong> (<cite>func</cite>) – Flow equation that takes position, state and gradient as its
arguments respectively.</p></li>
<li><p><strong>**kwargs</strong> (<cite>keyword arguments</cite>) – Extra arguments for the flow equation which are implemented
as defaults so that the calling signature of the flow equation
remains the same.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">fluxfunctions</span> <span class="k">as</span> <span class="n">fluxf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">conductivityfunctions</span> <span class="k">as</span> <span class="n">condf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility.helper</span> <span class="k">import</span> <span class="n">initializer</span>
</pre></div>
</div>
<p>Implement the Richards equation for unsturated flow, herein the
Van Genuchten conductivity function is used. <a class="bibtex reference internal" href="waterflow.html#strunk1979" id="id5">[SW79]</a>.
Soil 13, ‘loam’, from De Staringreeks <a class="bibtex reference internal" href="waterflow.html#strunk1979" id="id6">[SW79]</a> is selected.
See <a class="reference internal" href="waterflow.utility.html#waterflow.utility.fluxfunctions.richards_equation" title="waterflow.utility.fluxfunctions.richards_equation"><code class="xref py py-func docutils literal notranslate"><span class="pre">richards_equation()</span></code></a> for
the full definition of the fluxfunction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">condf</span><span class="o">.</span><span class="n">soilselector</span><span class="p">([</span><span class="mi">13</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kfun</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_conductivity</span><span class="p">,</span> <span class="n">ksat</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">ksat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">richards</span> <span class="o">=</span> <span class="n">fluxf</span><span class="o">.</span><span class="n">richards_equation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FErichard</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Flow equations&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FErichard</span><span class="o">.</span><span class="n">set_systemfluxfunction</span><span class="p">(</span><span class="n">richards</span><span class="p">,</span> <span class="n">kfun</span><span class="o">=</span><span class="n">kfun</span><span class="p">)</span>
</pre></div>
</div>
<p>For saturated flow the Darcy equation with a constant saturated
conductivity can be used. <a class="bibtex reference internal" href="waterflow.html#strunk1979" id="id7">[SW79]</a>. See
<a class="reference internal" href="waterflow.utility.html#waterflow.utility.fluxfunctions.darcy" title="waterflow.utility.fluxfunctions.darcy"><code class="xref py py-func docutils literal notranslate"><span class="pre">darcy()</span></code></a> for the full
definition of the fluxfunction.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">darcy</span> <span class="o">=</span> <span class="n">fluxf</span><span class="o">.</span><span class="n">darcy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FEdarcy</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Flow equations&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FEdarcy</span><span class="o">.</span><span class="n">set_systemfluxfunction</span><span class="p">(</span><span class="n">darcy</span><span class="p">,</span> <span class="n">ksat</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">ksat</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param">dt=0.001</em>, <em class="sig-param">dt_min=1e-05</em>, <em class="sig-param">dt_max=0.5</em>, <em class="sig-param">end_time=1</em>, <em class="sig-param">maxiter=500</em>, <em class="sig-param">dtitlow=1.5</em>, <em class="sig-param">dtithigh=0.5</em>, <em class="sig-param">itermin=5</em>, <em class="sig-param">itermax=10</em>, <em class="sig-param">threshold=0.001</em>, <em class="sig-param">verbosity=True</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>solve the system for a given period of time</p>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.states_to_function">
<code class="sig-name descname">states_to_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.states_to_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare one-dimensional interpolation function</p>
<p>One-dimensional piecewise linearly interpolated function which returns
the system’s states and is continiously defined on the domain
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nodes" title="waterflow.flow1d.flowFE1d.Flow1DFE.nodes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nodes</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Function that calculates the system’s states for a given position.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>functools.partial</cite></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The main purpose of this method is to allow for Gaussian quadrature
calculations which require state values at specific positions between
the system’s <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.nodes" title="waterflow.flow1d.flowFE1d.Flow1DFE.nodes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nodes</span></code></a>. This method also provides a tool for
plotting at arbitrary positions within the domain.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;Continiously defined states&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">((</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_initial_states</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continious_states</span> <span class="o">=</span> <span class="n">FE</span><span class="o">.</span><span class="n">states_to_function</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># On a boundary node</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continious_states</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">-10.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># In between two nodes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continious_states</span><span class="p">(</span><span class="o">-</span><span class="mf">8.5</span><span class="p">)</span>
<span class="go">-1.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># multiple results at once</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">continious_states</span><span class="p">([</span><span class="o">-</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)])</span>
<span class="go">array([-10. ,  -9.8,  -9.6,  -9.4,  -9.2,  -9. ])</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be aware that the function does not raise an exception but returns
the value of the nearest boundary when a position outside of the
domain is given as argument.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.summary">
<code class="sig-name descname">summary</code><span class="sig-paren">(</span><em class="sig-param">show=True</em>, <em class="sig-param">save=False</em>, <em class="sig-param">path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Description of the object</p>
<p>Subsequent calls will update the model description if
adaptations to the model were made.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>show</strong> (<cite>bool</cite>, default is True) – Print object description to the console.</p></li>
<li><p><strong>save</strong> (<cite>bool</cite>, default is False) – Save object description to disk.</p></li>
<li><p><strong>path</strong> (<cite>str</cite>, default is None) – Full path of a directory to which will be saved. This
argument is mandatory if <code class="docutils literal notranslate"><span class="pre">save=True</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The description of the model is saved as <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.id_" title="waterflow.flow1d.flowFE1d.Flow1DFE.id_"><code class="xref py py-attr docutils literal notranslate"><span class="pre">id_</span></code></a> with a`.txt`
extension. The string version of the description is also available via
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.summarystring" title="waterflow.flow1d.flowFE1d.Flow1DFE.summarystring"><code class="xref py py-attr docutils literal notranslate"><span class="pre">summarystring</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">conductivityfunctions</span> <span class="k">as</span> <span class="n">condf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">fluxfunctions</span> <span class="k">as</span> <span class="n">fluxf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility.helper</span> <span class="k">import</span> <span class="n">initializer</span>
</pre></div>
</div>
<p>Select soil 13, ‘loam’, from De Staringreeks <a class="bibtex reference internal" href="waterflow.html#strunk1979" id="id8">[SW79]</a>
and prepare the conductivity function and theta-h relation with the
soil parameters. These functions are the arguments to the fluxfunction
and the storage change function repectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">condf</span><span class="o">.</span><span class="n">soilselector</span><span class="p">([</span><span class="mi">13</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_h</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_pressureh</span><span class="p">,</span> <span class="n">theta_r</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">t_res</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">theta_s</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">t_sat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kfun</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_conductivity</span><span class="p">,</span> <span class="n">ksat</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">ksat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storage_change</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">fluxf</span><span class="o">.</span><span class="n">storage_change</span><span class="p">,</span> <span class="n">fun</span><span class="o">=</span><span class="n">theta_h</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;static df_states dataframe&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_systemfluxfunction</span><span class="p">(</span><span class="n">fluxf</span><span class="o">.</span><span class="n">richards_equation</span><span class="p">,</span> <span class="n">kfun</span><span class="o">=</span><span class="n">kfun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_dirichlet_BC</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;west&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Constant boundary flow of 0.3 cm/d out of the system</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;east&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># theta_h add manually to be included in the dataframe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">tfun</span> <span class="o">=</span> <span class="n">theta_h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># add spatial flux</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_spatialflux</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;extraction&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add storage change function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_spatialflux</span><span class="p">(</span><span class="n">storage_change</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Solve the system for one time step (dt=0.01 d)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iters</span> <span class="o">=</span> <span class="n">FE</span><span class="o">.</span><span class="n">dt_solve</span><span class="p">(</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="go">Id: static df_states dataframe</span>
<span class="go">System length: 10.0</span>
<span class="go">Number of nodes: 11</span>
<span class="go">Gauss degree: 1</span>
<span class="go">kfun: VG_conductivity</span>
<span class="go">tfun: VG_pressureh</span>
<span class="go">BCs: west value: 0.0 and of type Dirichlet, east value: -0.3 and of type Neumann</span>
<span class="go">Spatflux: extraction, storage_change</span>

<span class="go">spat-extraction   -1.000000e-02</span>
<span class="go">storage_change     1.255148e+00</span>
<span class="go">internal          -1.255148e+00</span>
<span class="go">all-spatial       -1.000000e-02</span>
<span class="go">all-points         0.000000e+00</span>
<span class="go">all-external      -1.000000e-02</span>
<span class="go">net                1.716294e-12</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.transient_dataframeify">
<code class="sig-name descname">transient_dataframeify</code><span class="sig-paren">(</span><em class="sig-param">print_times=None</em>, <em class="sig-param">include_maxima=True</em>, <em class="sig-param">nodes=None</em>, <em class="sig-param">invert=True</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.transient_dataframeify" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine the static dataframes to a transient collection</p>
<p>This method will build the following dataframes:
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dft_solved_times()</span></code></a>, <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_states" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_states"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_states</span></code></a>,
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_balance" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_balance"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_balance</span></code></a>, <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_balance_summary" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_balance_summary"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_balance_summary</span></code></a>.</p>
<p>Generation of <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_print_times" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_print_times"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_print_times</span></code></a> and <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_nodes" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_nodes"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_nodes</span></code></a>
depends on the <code class="docutils literal notranslate"><span class="pre">print_times</span></code> and <code class="docutils literal notranslate"><span class="pre">nodes</span></code> arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>print_times</strong> (<cite>int</cite>, <cite>list</cite> or <cite>numpy.ndarray</cite>) – Number of linearly spaced print times, or sequence of specific
print times.</p></li>
<li><p><strong>include_maxima</strong> (<cite>bool</cite>) – Include both endpoints in the dataframe.</p></li>
<li><p><strong>nodes</strong> (<cite>list</cite> or <cite>numpy.ndarray</cite>) – Positional values of the nodes that will be tracked over time.</p></li>
<li><p><strong>invert</strong> (<cite>bool</cite>) – Mirror the built dataframes w.r.t. the x-axis.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The default behaviour is to generate the dataframes for the times at
which the model has been solved. These times are selected by the
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.solve" title="waterflow.flow1d.flowFE1d.Flow1DFE.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a> method and saved in <a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_solved_times</span></code></a>.
When <code class="docutils literal notranslate"><span class="pre">print_times</span> <span class="pre">!=</span> <span class="pre">None</span></code>, the collection of the static dataframes
will be built at the new print times. This requires the model to
calculate new model objects. The calculations are done from the nearest
known object that was solved for in terms of time
(<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_solved_times"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_solved_times</span></code></a>) and will be saved in
<a class="reference internal" href="#waterflow.flow1d.flowFE1d.Flow1DFE.dft_print_times" title="waterflow.flow1d.flowFE1d.Flow1DFE.dft_print_times"><code class="xref py py-attr docutils literal notranslate"><span class="pre">dft_print_times</span></code></a>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.flow1d.flowFE1d</span> <span class="k">import</span> <span class="n">Flow1DFE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">conductivityfunctions</span> <span class="k">as</span> <span class="n">condf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility</span> <span class="k">import</span> <span class="n">fluxfunctions</span> <span class="k">as</span> <span class="n">fluxf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">waterflow.utility.helper</span> <span class="k">import</span> <span class="n">initializer</span>
</pre></div>
</div>
<p>Select soil 13, ‘loam’, from De Staringreeks <a class="bibtex reference internal" href="waterflow.html#strunk1979" id="id9">[SW79]</a>
and prepare the conductivity function and theta-h relation with the
soil parameters. These functions are the arguments to the fluxfunction
and the storage change function repectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">condf</span><span class="o">.</span><span class="n">soilselector</span><span class="p">([</span><span class="mi">13</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">theta_h</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_pressureh</span><span class="p">,</span> <span class="n">theta_r</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">t_res</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">theta_s</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">t_sat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kfun</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">condf</span><span class="o">.</span><span class="n">VG_conductivity</span><span class="p">,</span> <span class="n">ksat</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">ksat</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">storage_change</span> <span class="o">=</span> <span class="n">initializer</span><span class="p">(</span><span class="n">fluxf</span><span class="o">.</span><span class="n">storage_change</span><span class="p">,</span> <span class="n">fun</span><span class="o">=</span><span class="n">theta_h</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span> <span class="o">=</span> <span class="n">Flow1DFE</span><span class="p">(</span><span class="s2">&quot;All transient dataframes&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_systemfluxfunction</span><span class="p">(</span><span class="n">fluxf</span><span class="o">.</span><span class="n">richards_equation</span><span class="p">,</span> <span class="n">kfun</span><span class="o">=</span><span class="n">kfun</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_field1d</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_dirichlet_BC</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;west&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Constant boundary flow of 0.3 cm/d out of the system</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_neumann_BC</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;east&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># theta_h add manually to be included in the dataframe</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">tfun</span> <span class="o">=</span> <span class="n">theta_h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extraction of 0.001 cm/d over the complete domain</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_spatialflux</span><span class="p">(</span><span class="o">-</span><span class="mf">0.001</span><span class="p">,</span> <span class="s1">&#39;extraction&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Add storage change function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">add_spatialflux</span><span class="p">(</span><span class="n">storage_change</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">end_time</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">transient_dataframeify</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># returns None because it is empty</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">dft_print_times</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">dft_solved_times</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="go">                       solved_objects     time       dt  iter</span>
<span class="go">0  Flow1DFE(All transient dataframes)  0.00000      NaN   NaN</span>
<span class="go">1  Flow1DFE(All transient dataframes)  0.00100  0.00100   7.0</span>
<span class="go">2  Flow1DFE(All transient dataframes)  0.00200  0.00100   3.0</span>
<span class="go">3  Flow1DFE(All transient dataframes)  0.00350  0.00150   3.0</span>
<span class="go">4  Flow1DFE(All transient dataframes)  0.00575  0.00225   3.0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># access transient data from the top node</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">dft_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">        time  lengths  nodes      states  moisture  conductivities  extraction  storage_change  internal_forcing</span>
<span class="go">0   0.000000      5.0    0.0    0.000000  0.420000       12.980000      -0.005        0.000000        -12.980000</span>
<span class="go">1   0.001000      5.0    0.0   -6.230996  0.418228        6.881334      -0.005        4.413886         -4.108886</span>
<span class="go">2   0.002000      5.0    0.0   -8.525052  0.417231        6.149441      -0.005        3.381237         -3.076237</span>
<span class="go">3   0.003500      5.0    0.0  -10.769689  0.416145        5.570882      -0.005        2.713307         -2.408307</span>
<span class="go">4   0.005750      5.0    0.0  -13.147704  0.414894        5.058867      -0.005        2.213596         -1.908596</span>
<span class="go">5   0.009125      5.0    0.0  -15.759044  0.413423        4.583379      -0.005        1.816135         -1.511135</span>
<span class="go">6   0.014188      5.0    0.0  -18.682582  0.411673        4.131618      -0.005        1.490460         -1.185460</span>
<span class="go">7   0.021781      5.0    0.0  -21.992779  0.409584        3.698174      -0.005        1.219763         -0.914763</span>
<span class="go">8   0.033172      5.0    0.0  -25.766774  0.407089        3.281456      -0.005        0.993457         -0.688457</span>
<span class="go">9   0.050258      5.0    0.0  -30.088421  0.404117        2.882094      -0.005        0.804074         -0.499074</span>
<span class="go">10  0.075887      5.0    0.0  -35.050660  0.400591        2.502107      -0.005        0.645821         -0.340821</span>
<span class="go">11  0.114330      5.0    0.0  -40.755672  0.396435        2.144426      -0.005        0.513876         -0.208876</span>
<span class="go">12  0.171995      5.0    0.0  -47.311047  0.391582        1.812568      -0.005        0.404104         -0.099104</span>
<span class="go">13  0.258493      5.0    0.0  -54.818914  0.385985        1.510322      -0.005        0.312974         -0.007974</span>
<span class="go">14  0.388239      5.0    0.0  -63.353249  0.379645        1.241351      -0.005        0.237546          0.067454</span>
<span class="go">15  0.582859      5.0    0.0  -72.918234  0.372640        1.008723      -0.005        0.175458          0.129542</span>
<span class="go">16  0.874788      5.0    0.0  -83.379449  0.365167        0.814411      -0.005        0.124874          0.180126</span>
<span class="go">17  1.312682      5.0    0.0  -94.367200  0.357578        0.658911      -0.005        0.084417          0.220583</span>
<span class="go">18  1.812682      5.0    0.0 -103.335192  0.351603        0.559141      -0.005        0.058055          0.246945</span>
<span class="go">19  2.312682      5.0    0.0 -109.947478  0.347330        0.497676      -0.005        0.041411          0.263589</span>
<span class="go">20  2.812682      5.0    0.0 -114.891068  0.344208        0.457272      -0.005        0.030168          0.274832</span>
<span class="go">21  3.312682      5.0    0.0 -118.614160  0.341899        0.429578      -0.005        0.022269          0.282730</span>
<span class="go">22  3.812682      5.0    0.0 -121.429531  0.340177        0.410046      -0.005        0.016582          0.288417</span>
<span class="go">23  4.312682      5.0    0.0 -123.563493  0.338885        0.395994      -0.005        0.012421          0.292579</span>
<span class="go">24  4.812682      5.0    0.0 -125.183260  0.337912        0.385736      -0.005        0.009343          0.295657</span>
<span class="go">25  5.000000      5.0    0.0 -125.727039  0.337587        0.382369      -0.005        0.008330          0.296670</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Revert to initial model state</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">set_initial_states</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">end_time</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 5 linearly spaced print times</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">transient_dataframeify</span><span class="p">(</span><span class="n">nodes</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">],</span> <span class="n">print_times</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">dft_nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">   time  lengths  nodes      states  moisture  conductivities  extraction  storage_change  internal_forcing</span>
<span class="go">0  0.00      5.0    0.0    0.000000  0.420000       12.980000      -0.005        0.008330          0.296670</span>
<span class="go">1  1.25      5.0    0.0  -93.203885  0.358368        0.673469      -0.005        0.088281          0.216719</span>
<span class="go">2  2.50      5.0    0.0 -112.163382  0.345923        0.479024      -0.005        0.036331          0.268668</span>
<span class="go">3  3.75      5.0    0.0 -121.156173  0.340343        0.411892      -0.005        0.017130          0.287870</span>
<span class="go">4  5.00      5.0    0.0 -125.727039  0.337587        0.382369      -0.005        0.008330          0.296670</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">FE</span><span class="o">.</span><span class="n">dft_print_times</span>
<span class="go">                       solved_objects  time</span>
<span class="go">0  Flow1DFE(All transient dataframes)  0.00</span>
<span class="go">1  Flow1DFE(All transient dataframes)  1.25</span>
<span class="go">2  Flow1DFE(All transient dataframes)  2.50</span>
<span class="go">3  Flow1DFE(All transient dataframes)  3.75</span>
<span class="go">4  Flow1DFE(All transient dataframes)  5.00</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="waterflow.flow1d.flowFE1d.Flow1DFE.wrap_bf_linear">
<code class="sig-name descname">wrap_bf_linear</code><span class="sig-paren">(</span><em class="sig-param">node</em>, <em class="sig-param">where</em><span class="sig-paren">)</span><a class="headerlink" href="#waterflow.flow1d.flowFE1d.Flow1DFE.wrap_bf_linear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-waterflow.flow1d">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-waterflow.flow1d" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="waterflow.utility.html" class="btn btn-neutral float-right" title="waterflow.utility package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="waterflow.html" class="btn btn-neutral float-left" title="waterflow package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Bram Berendsen

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>